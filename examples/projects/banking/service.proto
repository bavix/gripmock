syntax = "proto3";

package banking;

service PaymentsService {
  rpc ProcessPayment (ProcessPaymentRequest) returns (ProcessPaymentResponse);
  rpc GetStatement (GetStatementRequest) returns (stream StatementItem);
  rpc UploadReceipts (stream Receipt) returns (UploadReceiptsResponse);
  rpc FraudAlerts (stream FraudEvent) returns (stream FraudDecision);
}

message ProcessPaymentRequest {
  string user_id = 1;
  string merchant_id = 2;
  double amount = 3;
  string currency = 4; // ISO-4217 code
}

message ProcessPaymentResponse {
  bool approved = 1;
  string approval_id = 2;
  double authorized_amount = 3;
  string currency = 4;
}

message GetStatementRequest {
  string user_id = 1;
  string from_date = 2; // ISO8601
  string to_date = 3;   // ISO8601
}

message StatementItem {
  string transaction_id = 1;
  string posted_at = 2; // ISO8601
  double amount = 3;
  string description = 4;
}

message Receipt {
  string receipt_id = 1;
  string receipt_type = 2; // pdf, image
  double total = 3;
}

message UploadReceiptsResponse {
  bool uploaded = 1;
  int32 count = 2;
  string status = 3;
}

message FraudEvent {
  string event_id = 1;
  string user_id = 2;
  string kind = 3; // login, card_swipe, overseas
}

message FraudDecision {
  string event_id = 1;
  string action = 2; // ALLOW/REVIEW/BLOCK
  string reason = 3;
}



